# Установка виджета на marketolo.ru

## Код для вставки

Вставьте этот код **перед закрывающим тегом `</body>`** на всех страницах сайта marketolo.ru:

```html
<!-- AI Widget для marketolo.ru -->
<script src="https://ai-studia.ru/widget.js?site=marketolo.ru" async></script>
```

## Где вставить код

### Вариант 1: В общий шаблон/футер (рекомендуется)

Если у вас есть общий шаблон или футер, который подключается на всех страницах, вставьте код туда.

**Пример для WordPress:**
- Перейдите в `Внешний вид` → `Редактор` → `footer.php`
- Вставьте код перед `</body>`

**Пример для HTML/CSS сайта:**
- Найдите файл с общим футером (например, `footer.html` или `includes/footer.php`)
- Вставьте код перед `</body>`

### Вариант 2: Через Google Tag Manager

1. Создайте новый тег типа "Пользовательский HTML"
2. Вставьте код виджета
3. Настройте триггер: "Все страницы"
4. Опубликуйте изменения

### Вариант 3: Прямо в HTML

Если у вас статический HTML, вставьте в каждую страницу перед `</body>`:

```html
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Marketolo - Премиальный маркетинг</title>
</head>
<body>
    <!-- Ваш контент -->
    
    <!-- AI Widget -->
    <script src="https://ai-studia.ru/widget.js?site=marketolo.ru" async></script>
</body>
</html>
```

## Проверка работы

После установки:

1. **Откройте любую страницу marketolo.ru**
2. **Проверьте, что виджет появился** в правом нижнем углу
3. **Откройте консоль браузера (F12)** и проверьте:
   - Нет ошибок загрузки
   - Сообщение: "AI Widget загружен и инициализирован"
   - Сообщение: "Site domain detected: marketolo.ru"

4. **Протестируйте виджет:**
   - Кликните на виджет
   - Отправьте тестовое сообщение
   - Проверьте, что ответ содержит информацию о Marketolo (не "нет информации")

## Настройка CORS на сервере

Убедитесь, что на сервере `ai-studia.ru` в файле `backend/server.js` настроен CORS для разрешения запросов с `marketolo.ru`:

```javascript
app.use(cors({
    origin: ['https://marketolo.ru', 'https://www.marketolo.ru', 'https://ai-studia.ru'],
    credentials: true,
}));
```

Или для разрешения всех доменов (менее безопасно, но проще для тестирования):

```javascript
app.use(cors({
    origin: '*',
    credentials: true,
}));
```

## Что будет работать

После установки виджет будет:
- ✅ Отображаться на всех страницах marketolo.ru
- ✅ Использовать контекст Marketolo для ответов ИИ
- ✅ Поддерживать голосовые сообщения
- ✅ Поддерживать текстовые сообщения
- ✅ Подключать к менеджеру

## Параметры виджета

Для marketolo.ru используется:
- `site=marketolo.ru` - для правильного контекста ИИ
- API по умолчанию: `https://ai-studia.ru`
- WebSocket по умолчанию: `https://ai-studia.ru`

## Устранение проблем

### Виджет не появляется
- Проверьте консоль браузера на ошибки
- Убедитесь, что файл `widget.js` доступен по адресу `https://ai-studia.ru/widget.js`
- Проверьте, что скрипт вставлен перед `</body>`

### Ошибки CORS
- Проверьте настройки CORS на сервере `ai-studia.ru`
- Убедитесь, что домен `marketolo.ru` добавлен в список разрешенных

### ИИ отвечает "нет информации"
- Проверьте логи сервера: должно быть `IsMarketoloDemo: true`
- Убедитесь, что параметр `site=marketolo.ru` указан в URL скрипта

## Контакты для поддержки

При возникновении проблем проверьте логи на сервере:
```bash
pm2 logs video-widget
```

Или обратитесь к разработчику для настройки.

